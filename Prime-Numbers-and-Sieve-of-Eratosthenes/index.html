<!DOCTYPE html>
<html lang="en">
<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGYYYX4F59"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LGYYYX4F59');
  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.92.2" />
  
  
      
  
  
  
  <meta name="description" content="A prime number is an integer n  1 which is only divisible by 1 and n(itself). For example, 2, 3, 5 are prime numbers, but 6, 8, 9 are not prime numbers.">
  <meta name="keywords" content="">
  <link rel="stylesheet" href="https://programmercave.com/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  
  
  
  <link rel="stylesheet" href="https://programmercave.com/css/cayman.ea0e967413f3851071cc8ace3621bc4205fe8fa79b2abe3d7bf94ff2841f0d47.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  <title>Prime Numbers and Sieve of Eratosthenes | programmerCave</title>
</head>

<body>
  <section class="page-header">
  <h1 class="project-name">
    programmerCave
  </h1>
  <nav>
    
    
      
      
      
      <a href="/" class="btn">Home</a>
    
      
      
      
      <a href="/tags/" class="btn">Tags</a>
    
      
      
      
      <a href="/index.xml" class="btn">RSS</a>
    
  </nav>
</section>

  <section class="main-content">
    
  <h1>Prime Numbers and Sieve of Eratosthenes</h1>
  <div>
    
    <strong>Publish date: </strong>2019-11-12
  </div>
  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
        
        
        
      
        
        
        
      
      <a href="https://programmercave.com/tags/Number-Theory/">Number-Theory</a>, <a href="https://programmercave.com/tags/Cpp/">Cpp</a>, <a href="https://programmercave.com/tags/Competitive-Programming/">Competitive-Programming</a>
    </div>
  
  <p>A <strong>prime number</strong> is an integer <em>n</em> &gt; 1 which is only divisible by 1 and <em>n</em>(itself). For example, 2, 3, 5 are prime numbers, but 6, 8, 9 are not prime numbers.</p>
<p>Every integer <em>n</em> &gt; 1 can be uniquely expressed as the product of prime numbers. For example 8 = 2 * 2 * 2.</p>
<!-- raw HTML omitted -->
<p>A <strong>perfect number</strong> is a number <em>n</em> if <em>n</em> is equal to the sum of its factors between 1 and <em>n</em> – 1. For example 28 is a perfect number because 28 = 1 + 2 + 4 + 7 + 14.</p>
<!-- raw HTML omitted -->
<ol>
<li>
<p><strong>Goldbach’s conjecture:</strong> Each even integer <em>n</em> &gt; 2 can be represented as a sum <em>n</em> = <em>a</em> + <em>b</em> such that both <em>a</em> and <em>b</em> are prime numbers. For example 12 = 5 + 7.</p>
</li>
<li>
<p><strong>Twin prime conjecture:</strong> There is an infinite number of pairs of the form {<em>p</em>, <em>p</em> + 2}, where both <em>p</em> and <em>p</em> + 2 are prime numbers. For example {5, 7}, {11, 13}.</p>
</li>
<li>
<p><strong>Legendre’s conjecture:</strong> There is always a prime between numbers n<!-- raw HTML omitted -->2<!-- raw HTML omitted --> and (n + 1)<!-- raw HTML omitted -->2<!-- raw HTML omitted -->, where <em>n</em> is any positive integer. For example 5 and 7 between 2<!-- raw HTML omitted -->2<!-- raw HTML omitted --> and 3<!-- raw HTML omitted -->2<!-- raw HTML omitted -->.</p>
</li>
</ol>
<!-- raw HTML omitted -->
<p>If a number <em>n</em> &gt; 1 is not a prime number then it has a factor between 2 and floor (√n). For example 27 = 3*9 and  √27 = 5.196 then 27 has a factor between 2 and 5 which is 3. So to test if a number is prime number we have to iterate to √n in a loop.</p>
<p>Here is a function <code>is_prime</code> which checks if the given number is prime.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#b00040">bool</span> <span style="color:#00f">is_prime</span>(<span style="color:#b00040">int</span> n)
{
	<span style="color:#008000;font-weight:bold">if</span> (n <span style="color:#666">&lt;</span> <span style="color:#666">2</span>)
	{
		<span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000">false</span>;
	}

	<span style="color:#008000;font-weight:bold">for</span> (<span style="color:#b00040">int</span> i <span style="color:#666">=</span> <span style="color:#666">2</span>; i<span style="color:#666">*</span>i <span style="color:#666">&lt;=</span> n; <span style="color:#666">++</span>i)
	{
		<span style="color:#008000;font-weight:bold">if</span> (n <span style="color:#666">%</span> i <span style="color:#666">==</span> <span style="color:#666">0</span>)
		{
			<span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000">false</span>;
		}
	}
	<span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000">true</span>;
}
</code></pre></div><p>Here is the function <code>prime_factorization</code> which returns an array of prime factors of the number.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">std<span style="color:#666">::</span>vector<span style="color:#666">&lt;</span><span style="color:#b00040">int</span><span style="color:#666">&gt;</span> prime_factorization(<span style="color:#b00040">int</span> n)
{
	std<span style="color:#666">::</span>vector<span style="color:#666">&lt;</span><span style="color:#b00040">int</span><span style="color:#666">&gt;</span> factors;

	<span style="color:#008000;font-weight:bold">for</span> (<span style="color:#b00040">int</span> i <span style="color:#666">=</span> <span style="color:#666">2</span>; i<span style="color:#666">*</span>i <span style="color:#666">&lt;=</span> n; <span style="color:#666">++</span>i)
	{
		<span style="color:#008000;font-weight:bold">while</span> (n <span style="color:#666">%</span> i <span style="color:#666">==</span> <span style="color:#666">0</span>)
		{
			factors.push_back(i);
			n <span style="color:#666">=</span> n <span style="color:#666">/</span> i;
		}
	}

	<span style="color:#008000;font-weight:bold">if</span> (n <span style="color:#666">&gt;</span> <span style="color:#666">1</span>)
	{
		factors.push_back(n);
	}
	<span style="color:#008000;font-weight:bold">return</span> factors;
}
</code></pre></div><!-- raw HTML omitted -->
<p>It is an efficient algorithm to find prime numbers upto a limit (say 10,000,000).</p>
<p>In this algorithm, first we mark all the multiples of 2 upto n, then all the multiples of 3, then 5 and so on. In the end we have all the prime numbers upto n.</p>
<p>For example, to find prime numbers less tha or equal to 20.</p>
<p>2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</p>
<p>Now we mark all the multiples of 2 except 2 with red.</p>
<p>2 3 <!-- raw HTML omitted -->4<!-- raw HTML omitted --> 5 <!-- raw HTML omitted -->6<!-- raw HTML omitted --> 7 <!-- raw HTML omitted -->8<!-- raw HTML omitted --> 9 <!-- raw HTML omitted -->10<!-- raw HTML omitted --> 11 <!-- raw HTML omitted -->12<!-- raw HTML omitted --> 13 <!-- raw HTML omitted -->14<!-- raw HTML omitted --> 15 <!-- raw HTML omitted -->16<!-- raw HTML omitted --> 17 <!-- raw HTML omitted -->18<!-- raw HTML omitted --> 19 <!-- raw HTML omitted -->20<!-- raw HTML omitted --></p>
<p>Now we mark all the multiples of 3 except 3 with red.</p>
<p>2 3 <!-- raw HTML omitted -->4<!-- raw HTML omitted --> 5 <!-- raw HTML omitted -->6<!-- raw HTML omitted --> 7 <!-- raw HTML omitted -->8<!-- raw HTML omitted --> <!-- raw HTML omitted -->9<!-- raw HTML omitted --> <!-- raw HTML omitted -->10<!-- raw HTML omitted --> 11 <!-- raw HTML omitted -->12<!-- raw HTML omitted --> 13 <!-- raw HTML omitted -->14<!-- raw HTML omitted --> <!-- raw HTML omitted -->15<!-- raw HTML omitted --> <!-- raw HTML omitted -->16<!-- raw HTML omitted --> 17 <!-- raw HTML omitted -->18<!-- raw HTML omitted --> 19 <!-- raw HTML omitted -->20<!-- raw HTML omitted --></p>
<p>The remaining integers in black are prime numbers less than 20.</p>
<p>Here is the function <code>sieve_of_erastosthenes</code> which returns an array whose index can tell us the prime numbers less than or equal to <em>n</em>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">std<span style="color:#666">::</span>vector<span style="color:#666">&lt;</span><span style="color:#b00040">bool</span><span style="color:#666">&gt;</span> sieve_of_erastosthenes(<span style="color:#b00040">int</span> n)
{
	std<span style="color:#666">::</span>vector<span style="color:#666">&lt;</span><span style="color:#b00040">bool</span><span style="color:#666">&gt;</span> is_prime(n<span style="color:#666">+</span><span style="color:#666">1</span>, <span style="color:#008000">true</span>);

	is_prime[<span style="color:#666">0</span>] <span style="color:#666">=</span> is_prime[<span style="color:#666">1</span>] <span style="color:#666">=</span> <span style="color:#008000">false</span>;

	<span style="color:#008000;font-weight:bold">for</span> (<span style="color:#b00040">int</span> i <span style="color:#666">=</span> <span style="color:#666">2</span>; i <span style="color:#666">&lt;=</span> n; <span style="color:#666">++</span>i)
	{
		<span style="color:#008000;font-weight:bold">if</span> (is_prime[i])
		{
			<span style="color:#008000;font-weight:bold">for</span> (<span style="color:#b00040">int</span> j <span style="color:#666">=</span> i<span style="color:#666">*</span>i; j <span style="color:#666">&lt;=</span> n; j <span style="color:#666">+=</span> i)
			{
				is_prime[j] <span style="color:#666">=</span> <span style="color:#008000">false</span>;
			}
		}
	}
	<span style="color:#008000;font-weight:bold">return</span> is_prime;
}
</code></pre></div><p>Reference - Competitive Programmer’s Handbook, Antti Laaksonen</p>

  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
        
        
        
      
        
        
        
      
      <a href="https://programmercave.com/tags/Number-Theory/">Number-Theory</a>, <a href="https://programmercave.com/tags/Cpp/">Cpp</a>, <a href="https://programmercave.com/tags/Competitive-Programming/">Competitive-Programming</a>
    </div>
  

    <footer class="site-footer">
  <span class="site-footer-credits">
  <h3>Referral alert:</h3>
    <p><b><a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a>:</b> If you are considering enrolling in <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a> and would like a referral and discount on your fees, I can help. As a Scaler alumnus, I can provide referrals. Use my <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">referral link</a> if you have decided to join <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a>. If you want to know more about Scaler Academy, drop a mail at <a href="mailto:programmercave@gmail.com">programmercave@gmail.com</a></p> 
    
    <a href="https://programmercave.com" class="fa fa-home"></a>

    <a href="https://www.facebook.com/programmercave" class="fab fa-facebook"></a>

    <a href="https://github.com/abhiabhi0" class="fab fa-github"></a>

    <a href="https://twitter.com/programmercave" class="fab fa-twitter"></a>

    <a href="https://medium.com/@programmercave0" class="fab fa-medium"></a>

    <a href="https://www.instagram.com/programmercave" class="fab fa-instagram"></a>

    <a href="https://t.me/programmercave" class="fab fa-telegram"></a>

    <a href="https://www.youtube.com/channel/UCGpGM7FBgVm7Cmuo6OrUYGQ" class="fab fa-youtube"></a>

    <p>Copyright © 2025 programmerCave</p>  </span>
</footer>

  </section>
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'G-LGYYYX4F59', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

</body>
</html>
