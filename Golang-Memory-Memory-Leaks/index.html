<!DOCTYPE html>
<html lang="en">
<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGYYYX4F59"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LGYYYX4F59');
  </script>

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6819793054373827"
     crossorigin="anonymous"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.123.7">
  
  
      
  
  
  
  <meta name="description" content="Introduction Even though Go has a garbage collector, it is still possible to have memory leaks. A memory leak in Go doesnâ€™t mean the GC is broken; it means you have accidentally kept a reference to an object that you no longer need, preventing the GC from reclaiming its memory.
Analogy: A memory leak is like putting a box in a long-term storage unit and then forgetting you have the key.">
  <meta name="keywords" content="Go, programming, language,, Golang, speed,, compiled, languages,, concurrency, in, Go,, goroutines,, Go, garbage, collection,, high-performance, applications,, Go, interview, preparation,, native, compilation,, modern, hardware, optimization,, fast, compile, times,, efficient, coding, practices,, Golang, features">
  <link rel="stylesheet" href="https://programmercave.com/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  
  
  
  <link rel="stylesheet" href="https://programmercave.com/css/cayman.ea0e967413f3851071cc8ace3621bc4205fe8fa79b2abe3d7bf94ff2841f0d47.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  <title>Golang - Memory - Memory Leaks | programmerCave</title>
</head>

<body>
  <section class="page-header">
  <h1 class="project-name">
    programmerCave
  </h1>
  <nav>
    
    
      
      
      
      <a href="/" class="btn">Home</a>
    
      
      
      
      <a href="/tags/" class="btn">Tags</a>
    
      
      
      
      <a href="/index.xml" class="btn">RSS</a>
    
  </nav>
</section>

  <section class="main-content">
    
  <h1>Golang - Memory - Memory Leaks</h1>
  <div>
    
    <strong>Publish date: </strong>2025-09-23
  </div>
  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
      &lt;a href=&#34;https://programmercave.com/tags/Go/&#34;&gt;Go&lt;/a&gt;
    </div>
  
  <h3 id="introduction">Introduction</h3>
<p>Even though Go has a garbage collector, it is still possible to have memory leaks. A memory leak in Go doesn&rsquo;t mean the GC is broken; it means you have accidentally kept a reference to an object that you no longer need, preventing the GC from reclaiming its memory.</p>
<p><strong>Analogy:</strong> A memory leak is like putting a box in a <strong>long-term storage unit and then forgetting you have the key</strong>. The storage company (the GC) sees that you are still the owner, so it will never throw the box away, even if you never intend to use its contents again. The box just sits there, taking up space you have to pay for.</p>
<hr>
<h3 id="common-causes-of-memory-leaks-in-go">Common Causes of Memory Leaks in Go</h3>
<h4 id="1-leaking-goroutines">1. Leaking Goroutines</h4>
<p>This is the most common cause of memory leaks in Go. A goroutine is a lightweight thread, but it still consumes memory (starting at 2KB for its stack, which can grow). If you start a goroutine that blocks forever and never terminates, its memory is never released.</p>
<p><strong>Example: A Blocked Channel Send/Receive</strong></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">// A goroutine that waits to receive from a channel.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic">// If nothing is ever sent, it will block forever.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">worker</span>(ch <span style="color:#666">&lt;-</span><span style="color:#008000;font-weight:bold">chan</span> <span style="color:#b00040">int</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">for</span> {
</span></span><span style="display:flex;"><span>        val <span style="color:#666">:=</span> <span style="color:#666">&lt;-</span>ch <span style="color:#408080;font-style:italic">// Blocks here
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>        fmt.<span style="color:#00f">Println</span>(val)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
</span></span><span style="display:flex;"><span>    ch <span style="color:#666">:=</span> <span style="color:#008000">make</span>(<span style="color:#008000;font-weight:bold">chan</span> <span style="color:#b00040">int</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">go</span> <span style="color:#00f">worker</span>(ch) <span style="color:#408080;font-style:italic">// This goroutine is now leaked.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">// The main goroutine exits, but in a long-running server,
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    <span style="color:#408080;font-style:italic">// this worker would be stuck in memory forever.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>}
</span></span></code></pre></div><p><strong>How to prevent:</strong></p>
<ul>
<li>Ensure every goroutine you start has a clear exit condition.</li>
<li>Use <code>context</code> cancellation to signal goroutines to shut down.</li>
<li>Use buffered channels or <code>select</code> statements with a <code>default</code> or <code>timeout</code> case to prevent indefinite blocking.</li>
</ul>
<h4 id="2-unbounded-global-collections-maps-and-slices">2. Unbounded Global Collections (Maps and Slices)</h4>
<p>If you have a global map or slice that you only ever add to, it will grow indefinitely, consuming more and more memory.</p>
<p><strong>Example: A Global Cache Without an Eviction Policy</strong></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">// A simple cache that is never cleared.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">var</span> cache = <span style="color:#008000">make</span>(<span style="color:#008000;font-weight:bold">map</span>[<span style="color:#b00040">string</span>]<span style="color:#b00040">string</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">handleRequest</span>(key <span style="color:#b00040">string</span>) <span style="color:#b00040">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> val, ok <span style="color:#666">:=</span> cache[key]; ok {
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">return</span> val
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">// ... calculate value ...
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    val <span style="color:#666">:=</span> <span style="color:#ba2121">&#34;some calculated value&#34;</span>
</span></span><span style="display:flex;"><span>    cache[key] = val <span style="color:#408080;font-style:italic">// Add to cache, but never remove.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">return</span> val
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>How to prevent:</strong></p>
<ul>
<li>Avoid global variables for request-scoped data.</li>
<li>If you need a cache, implement a bounding and eviction strategy (e.g., LRU - Least Recently Used, or TTL - Time To Live).</li>
</ul>
<h4 id="3-dangling-slices-substring-memory-leak">3. Dangling Slices (Substring Memory Leak)</h4>
<p>When you take a slice of a larger slice or array, the new slice&rsquo;s header still points to the original, large backing array. If the original large array is no longer needed <em>except</em> for that small slice, the GC cannot free the large array.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#408080;font-style:italic">// This function reads a 10MB file into memory, but only returns the first 5 bytes.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">getHeader</span>() []<span style="color:#b00040">byte</span> {
</span></span><span style="display:flex;"><span>    largeData, _ <span style="color:#666">:=</span> ioutil.<span style="color:#00f">ReadFile</span>(<span style="color:#ba2121">&#34;largefile.dat&#34;</span>) <span style="color:#408080;font-style:italic">// 10MB
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">return</span> largeData[:<span style="color:#666">5</span>] <span style="color:#408080;font-style:italic">// This slice still holds a reference to the 10MB array!
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">// The header variable is small, but it&#39;s preventing 10MB from being garbage collected.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    header <span style="color:#666">:=</span> <span style="color:#00f">getHeader</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">// ... use header ...
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>}
</span></span></code></pre></div><p><strong>How to prevent:</strong></p>
<ul>
<li>When taking a small slice from a large one that you intend to keep, make an explicit copy.</li>
</ul>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">getHeaderFixed</span>() []<span style="color:#b00040">byte</span> {
</span></span><span style="display:flex;"><span>    largeData, _ <span style="color:#666">:=</span> ioutil.<span style="color:#00f">ReadFile</span>(<span style="color:#ba2121">&#34;largefile.dat&#34;</span>)
</span></span><span style="display:flex;"><span>    header <span style="color:#666">:=</span> <span style="color:#008000">make</span>([]<span style="color:#b00040">byte</span>, <span style="color:#666">5</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#008000">copy</span>(header, largeData[:<span style="color:#666">5</span>]) <span style="color:#408080;font-style:italic">// Make a copy
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">return</span> header <span style="color:#408080;font-style:italic">// Now it has its own small backing array.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>}
</span></span></code></pre></div><hr>
<h3 id="detecting-memory-leaks-with-pprof">Detecting Memory Leaks with <code>pprof</code></h3>
<p>Go comes with a powerful built-in profiling tool called <code>pprof</code>. It is the standard way to diagnose memory and CPU issues.</p>
<p><strong>How to use <code>pprof</code> for memory leaks:</strong></p>
<ol>
<li>
<p><strong>Expose the <code>pprof</code> endpoints:</strong> Add the <code>net/http/pprof</code> package to your application. This will register HTTP handlers for profiling data on your debug server.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>    _ <span style="color:#ba2121">&#34;net/http/pprof&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ba2121">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ba2121">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">func</span> <span style="color:#00f">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">go</span> <span style="color:#008000;font-weight:bold">func</span>() {
</span></span><span style="display:flex;"><span>        log.<span style="color:#00f">Println</span>(http.<span style="color:#00f">ListenAndServe</span>(<span style="color:#ba2121">&#34;localhost:6060&#34;</span>, <span style="color:#008000;font-weight:bold">nil</span>))
</span></span><span style="display:flex;"><span>    }()
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">// ... your application logic ...
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>}
</span></span></code></pre></div></li>
<li>
<p><strong>Capture a Heap Profile:</strong> While your application is running (and potentially leaking), use the <code>go tool pprof</code> to look at the heap. The most useful profile is <code>inuse_space</code>, which shows memory that is currently allocated.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#408080;font-style:italic"># This command will open an interactive pprof session</span>
</span></span><span style="display:flex;"><span>go tool pprof http://localhost:6060/debug/pprof/heap
</span></span></code></pre></div></li>
<li>
<p><strong>Analyze the Profile:</strong> Inside the <code>pprof</code> tool, you can use commands to analyze the data:</p>
<ul>
<li><code>top</code>: Shows the functions that are holding the most memory. If you see a function at the top that you expect to be short-lived, it&rsquo;s a sign of a leak.</li>
<li><code>list &lt;function_name&gt;</code>: Shows the source code of the function, with memory usage annotated line-by-line.</li>
<li><code>web</code>: Generates a visual graph (in SVG format) of the memory usage, which can make it very easy to spot the source of a leak.</li>
</ul>
</li>
</ol>
<p>By taking heap profiles at different times, you can compare them to see where memory is growing unexpectedly, leading you directly to the source of the leak.</p>

  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
      &lt;a href=&#34;https://programmercave.com/tags/Go/&#34;&gt;Go&lt;/a&gt;
    </div>
  

    <footer class="site-footer">
  <span class="site-footer-credits">
  <h3>Promotions:</h3>
    <p><b><a href="https://atmanamviddhi.in/" target="_blank">Atmanam Viddhi</a>:</b> Visit <a href="https://atmanamviddhi.in/" target="_blank">Atmanam Viddhi</a> to embark on a journey of self-discovery and appreciation. This platform offers daily wisdom from timeless philosophical texts, guiding you to cultivate gratitude and affirm your divine nature. By writing down your gratitude and affirmations, you'll connect with your inner self and unlock a path to profound personal growth and spiritual awakening. Join the community today and start transforming your life with the power of reflection and affirmation!</p>  

    <p><b><a href="https://lovable.dev/?via=programmercave" target="_blank">Lovable</a>:</b> Tired of coding? <a href="https://lovable.dev/?via=programmercave" target="_blank">Lovable</a> is your AI-powered full-stack engineer! Go from idea to fully functional app in minutes. Perfect for founders, designers, and product teams. Try it now!</p>

    <p><b><a href="https://bytebytego.com?fpr=programmercave" target="_blank">ByteByteGo</a>:</b> Master system design with <a href="https://bytebytego.com?fpr=programmercave" target="_blank">ByteByteGo</a>, the ultimate resource for cracking interviews and building scalable systems! Their comprehensive courses simplify complex concepts using visual aids, real-world examples, and structured lessons, making learning engaging and effective. Whether you're a beginner or an experienced engineer, <a href="https://bytebytego.com?fpr=programmercave" target="_blank">ByteByteGo</a> equips you with the skills top tech companies demand. Gain in-depth knowledge of distributed systems, microservices, and high-level architecture to excel in your career. Don't just prepareâ€”ace your system design interviews with confidence! ðŸš€ Start learning today and take your skills to the next level</p>

    <p><b><a href="https://namastedev.com?_aff=1738041847176" target="_blank">NamasteDev</a>:</b> Unlock your coding potential with <a href="https://namastedev.com?_aff=1738041847176" target="_blank">NamasteDev</a>, the ultimate EdTech platform for aspiring developers! Whether you're a beginner or looking to advance, <a href="https://namastedev.com?_aff=1738041847176" target="_blank">NamasteDev</a> offers top-tier courses like Namaste React, Namaste Node.js, and Frontend System Designâ€”all designed for self-paced, project-based learning. Learn from industry experts, build real-world projects, and stay ahead with the latest tech trends. Join a thriving community of learners and take your skills to the next level. Start your journey today and open the door to endless career opportunities. Level up with NamasteDevâ€”where learning meets innovation! ðŸš€ðŸ”¥</p>

    <p><b><a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a>:</b> Elevate your tech career with <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler</a>! Join a community dedicated to transforming careers in technology. With over 15,000 successful career transitions and partnerships with 900+ placement partners, <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler</a> offers tailored learning experiences that can help you become part of the top 1% in the tech industry. <br>
    Explore a variety of programs, participate in live classes, and gain access to valuable resources designed to enhance your skills. Whether you're looking to advance in your current role or pivot to a new career, <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler</a> provides the support and guidance you need to succeed. Don't miss outâ€”book your free live class today!</p> 
    
    <a href="https://programmercave.com/" class="fa fa-home"></a>

    <a href="https://www.facebook.com/programmercave" class="fab fa-facebook"></a>

    <a href="https://github.com/abhiabhi0" class="fab fa-github"></a>

    <a href="https://twitter.com/programmercave" class="fab fa-twitter"></a>

    <a href="https://medium.com/@programmercave0" class="fab fa-medium"></a>

    <a href="https://www.instagram.com/programmercave" class="fab fa-instagram"></a>

    <a href="https://t.me/programmercave" class="fab fa-telegram"></a>

    <a href="https://www.youtube.com/channel/UCGpGM7FBgVm7Cmuo6OrUYGQ" class="fab fa-youtube"></a>

    <p>Copyright Â© 2025 programmerCave</p>  </span>
</footer>

  </section>
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'G-LGYYYX4F59', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  


  <script type="text/javascript">
    var infolinks_pid = 3210490;
    var infolinks_wsid = 0;
    </script>
    <script type="text/javascript" src="http://resources.infolinks.com/js/infolinks_main.js"></script>
</body>
</html>
