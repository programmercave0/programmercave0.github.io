<!DOCTYPE html>
<html lang="en">
<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LGYYYX4F59"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LGYYYX4F59');
  </script>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6819793054373827"
crossorigin="anonymous"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.92.2" />
  
  
      
  
  
  
  <meta name="description" content="Learn linux command by playing Leviathan wargame from OverTheWire. This wargame doesn&#39;t require any knowledge about programming - just a bit of common sense and some knowledge about basic *nix commands. Below is the solution of Level 3 → Level 4 and Level 4 → Level 5. In this post we will learn how to use a debugging tool ltrace to exploit a program and how to convert binary to ASCII in Python 3">
  <meta name="keywords" content="">
  <link rel="stylesheet" href="https://programmercave.com/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  
  
  
  <link rel="stylesheet" href="https://programmercave.com/css/cayman.ea0e967413f3851071cc8ace3621bc4205fe8fa79b2abe3d7bf94ff2841f0d47.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  <title>Leviathan Level 3 to Level 4 | Basic Exploitation Techniques | programmerCave</title>
</head>

<body>
  <section class="page-header">
  <h1 class="project-name">
    programmerCave
  </h1>
  <nav>
    
    
      
      
      
      <a href="/" class="btn">Home</a>
    
      
      
      
      <a href="/tags/" class="btn">Tags</a>
    
      
      
      
      <a href="/index.xml" class="btn">RSS</a>
    
  </nav>
</section>

  <section class="main-content">
    
  <h1>Leviathan Level 3 to Level 4 | Basic Exploitation Techniques</h1>
  <div>
    
    <strong>Publish date: </strong>2020-01-06
  </div>
  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
        
        
        
      
        
        
        
      
      <a href="https://programmercave.com/tags/Linux/">Linux</a>, <a href="https://programmercave.com/tags/OverTheWire-Leviathan/">OverTheWire-Leviathan</a>, <a href="https://programmercave.com/tags/CTF/">CTF</a>
    </div>
  
  <p>Learn linux command by playing <a href="https://overthewire.org/wargames/leviathan/">Leviathan</a> wargame from OverTheWire. This wargame doesn&rsquo;t require any knowledge about programming - just a bit of common sense and some knowledge about basic *nix commands.</p>
<p>Below is the solution of Level 3 → Level 4 and Level 4 → Level 5. In this post we will learn how to use a debugging tool <strong>ltrace</strong> to exploit a program and how to convert binary to ASCII in Python 3.</p>
<p><img src="/assets/images/Leviathan-OverTheWire/overthewire_poster.jpg" alt="Leviathan OverTheWire"></p>
<h3 id="previous-posts">Previous Posts</h3>
<p><a href="/Leviathan-Level-0-to-Level-1-OverTheWire">Leviathan Level 0 to Level 1</a><!-- raw HTML omitted -->
<a href="/Leviathan-Level-2-3-Basic-Exploitation-Techniques">Leviathan Level 2 → Level 3</a><!-- raw HTML omitted --></p>
<h2 id="leviathan-level-3--level-4httpsoverthewireorgwargamesleviathanleviathan4html"><a href="https://overthewire.org/wargames/leviathan/leviathan4.html">Leviathan Level 3 → Level 4</a></h2>
<p>Command to login is <code>ssh leviathan3@leviathan.labs.overthewire.org -p 2223</code> and password is  <code>Ahdiemoo1j</code> .</p>
<p>This level is same as the level 1. We have a binary file <em>level</em>. When we execute it, it asks for a password and we do not know that password.</p>
<p><img src="/assets/images/Leviathan-OverTheWire/levi_l34_terminal1.jpg" alt="Leviathan OverTheWire"></p>
<p>We will use <code>ltrace</code> command to find the system call executed. The command is <code>ltrace ./level3</code> and when we are prompted for the password we enter <em>test</em>.</p>
<p>The function <code>strcmp</code> compares <em>test</em> with <em>snlprintf</em> means the password is <em>snlprintf</em>.</p>
<p><img src="/assets/images/Leviathan-OverTheWire/levi_l34_terminal2.jpg" alt="Leviathan OverTheWire"></p>
<p>After entering this password we are into the root shell and from here can see the password for the next level using command <code>cat /etc/leviathan_pass/leviathan4</code> and the password is <code>vuH0coox6m</code> .</p>
<p><img src="/assets/images/Leviathan-OverTheWire/levi_l34_terminal3.jpg" alt="Leviathan OverTheWire"></p>
<!-- raw HTML omitted -->
<h2 id="leviathan-level-4--level-5httpsoverthewireorgwargamesleviathanleviathan5html"><a href="https://overthewire.org/wargames/leviathan/leviathan5.html">Leviathan Level 4 → Level 5</a></h2>
<p>Command to login is <code>ssh leviathan4@leviathan.labs.overthewire.org -p 2223</code> and password is  <code>vuH0coox6m</code> .</p>
<p>We have only <em>.trash</em> directory which is new, so change into that directory using <code>cd .trash</code></p>
<p>In <em>.trash</em> directory there is <em>bin</em> binary file and executing it outputs in 0s and 1s. Maybe this is our password, so lets convert it into ASCII.</p>
<p><img src="/assets/images/Leviathan-OverTheWire/levi_l45_terminal1.jpg" alt="Leviathan OverTheWire"></p>
<p>Open another terminal and enter <code>python3</code> and then <code>import binascii</code>.</p>
<p>The <code>binascii</code> module contains a number of methods to convert between binary and various ASCII-encoded binary representations.</p>
<p>The function <code>int(‘binary_data’, 2)</code> returns an integer object.</p>
<p><code>bit_length()</code> return the number of bits necessary to represent an integer in binary, excluding the sign and leading zeros.</p>
<p><code>to_bytes(length, byteorder, *, signed=False)</code> return an array of bytes representing an integer.</p>
<p>To convert bytes to string use <code>decode()</code> function, which creates string from the bytes.</p>
<p>These lines will output our password</p>
<pre tabindex="0"><code>&gt;&gt;&gt; import binascii
&gt;&gt;&gt; n = int('0101010001101001011101000110100000110100011000110110111101101011011001010110100100001010',2)
&gt;&gt;&gt; n.to_bytes((n.bit_length() + 7) // 8, 'big').decode()
'Tith4cokei\n'
</code></pre><p>and the password is <code>Tith4cokei</code> .</p>
<p><img src="/assets/images/Leviathan-OverTheWire/levi_l45_terminal2.jpg" alt="Leviathan OverTheWire"></p>
<p>Reference : <a href="https://unix.stackexchange.com/questions/98948/ascii-to-binary-and-binary-to-ascii-conversion-tools">ASCII to Binary and Binary to ASCII conversion tools?</a><!-- raw HTML omitted -->
<a href="https://docs.python.org/3/library/binascii.html#module-binascii">binascii — Convert between binary and ASCII</a><!-- raw HTML omitted -->
<a href="https://docs.python.org/3.4/library/functions.html?highlight=int#int">Built-in Functions – int()</a><!-- raw HTML omitted -->
<a href="https://docs.python.org/3/library/stdtypes.html">Built-in Types</a><!-- raw HTML omitted -->
<a href="https://docs.python.org/3/howto/unicode.html">Unicode HOWTO</a><!-- raw HTML omitted --></p>
<h3 id="next-posts">Next Posts</h3>
<p><a href="/Leviathan-Level-5-to-6-Basic-Exploitation-Techniques">Leviathan Level 5 to Level 6</a><!-- raw HTML omitted --></p>

  
  
    <div>
      <strong>Tags: </strong>
      
        
        
        
      
        
        
        
      
        
        
        
      
      <a href="https://programmercave.com/tags/Linux/">Linux</a>, <a href="https://programmercave.com/tags/OverTheWire-Leviathan/">OverTheWire-Leviathan</a>, <a href="https://programmercave.com/tags/CTF/">CTF</a>
    </div>
  

    <footer class="site-footer">
  <span class="site-footer-credits">
  <h3>Referral alert:</h3>
    <p><b><a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a>:</b> If you are considering enrolling in <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a> and would like a referral and discount on your fees, I can help. As a Scaler alumnus, I can provide referrals. Use my <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">referral link</a> if you have decided to join <a href="https://www.scaler.com?unlock_code=MAIL575E" target="_blank">Scaler Academy</a>. If you want to know more about Scaler Academy, drop a mail at <a href="mailto:programmercave@gmail.com">programmercave@gmail.com</a></p> 
    
    <a href="https://programmercave.com" class="fa fa-home"></a>

    <a href="https://www.facebook.com/programmercave" class="fab fa-facebook"></a>

    <a href="https://github.com/abhiabhi0" class="fab fa-github"></a>

    <a href="https://twitter.com/programmercave" class="fab fa-twitter"></a>

    <a href="https://medium.com/@programmercave0" class="fab fa-medium"></a>

    <a href="https://www.instagram.com/programmercave" class="fab fa-instagram"></a>

    <a href="https://t.me/programmercave" class="fab fa-telegram"></a>

    <a href="https://www.youtube.com/channel/UCGpGM7FBgVm7Cmuo6OrUYGQ" class="fab fa-youtube"></a>

    <p>Copyright © 2025 programmerCave</p>  </span>
</footer>

  </section>
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'G-LGYYYX4F59', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

</body>
</html>
